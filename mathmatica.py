import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit

# Manually input the data for each Gy level
data10Gy = {
    'Temperature': np.array([20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124, 126, 128, 130, 132, 134, 136, 138, 140, 142, 144, 146, 148, 150, 152, 154, 156, 158, 160, 162, 164, 166, 168, 170, 172, 174, 176, 178, 180, 182, 184, 186, 188, 190, 192, 194, 196, 198, 200, 202, 204, 206, 208, 210, 212, 214, 216, 218, 220, 222, 224, 226, 228, 230, 232, 234, 236, 238, 240, 242, 244, 246, 248, 250, 252, 254, 256, 258, 260, 262, 264, 266, 268, 270, 272, 274, 276, 278, 280, 282, 284, 286, 288, 290, 292, 294, 296, 298, 300, 302, 304, 306, 308, 310, 312, 314, 316, 318, 320, 322, 324, 326, 328, 330, 332, 334, 336, 338, 340, 342, 344, 346, 348, 350, 352, 354, 356, 358, 360, 362, 364, 366, 368, 370, 372, 374, 376, 378, 380, 382, 384, 386, 388, 390, 392, 394, 396, 398, 400 ]),  # Replace with your actual data

    'TL Intensity': np.array([773, 727, 828, 1056, 1255, 1711, 2108, 2624, 3263, 4017, 4919, 5898, 6869, 8173, 9619, 11401, 13441, 15575, 18490, 21841, 25003, 29088, 33798, 37320, 41608, 45455, 48769, 50347, 50952, 51161, 49833, 45783, 42782, 38560, 33230, 28048, 22461, 17852, 13894, 11404, 9845, 8727, 7868, 7090, 6598, 5937, 5322, 4827, 5038, 5044, 4890, 5241, 5209, 5417, 5457, 5439, 5304, 5536, 5256, 5462, 5615, 5377, 5401, 5522, 5359, 5382, 5162, 5070, 4961, 4799, 4454, 4385, 4221, 4124, 4069, 4039, 4032, 3787, 3517, 3583, 2915, 2585, 2326, 1905, 1623, 1307, 997, 770, 646, 545, 474, 398, 445, 335, 318, 321, 319, 271, 232, 264, 274, 252, 225, 278, 243, 326, 213, 213, 200, 211, 202, 167, 214, 157, 168, 186, 194, 194, 186, 165, 171, 189, 157, 128, 120, 151, 160, 182, 124, 145, 115, 161, 170, 164, 98, 170, 116, 136, 147, 120, 131, 133, 151, 146, 170, 134, 184, 172, 111, 82, 147, 97, 110, 147, 104, 151, 144, 112, 189, 90, 78, 112, 138, 139, 83, 67, 126, 118, 116, 145, 108, 99, 142, 115, 119, 98, 135, 121, 161, 119, 137, 103, 83, 80, 155, 92, 119, 153, 130, 94, 169
])      # Replace with your actual data
}

data20Gy = {
    'Temperature': np.array([20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124, 126, 128, 130, 132, 134, 136, 138, 140, 142, 144, 146, 148, 150, 152, 154, 156, 158, 160, 162, 164, 166, 168, 170, 172, 174, 176, 178, 180, 182, 184, 186, 188, 190, 192, 194, 196, 198, 200, 202, 204, 206, 208, 210, 212, 214, 216, 218, 220, 222, 224, 226, 228, 230, 232, 234, 236, 238, 240, 242, 244, 246, 248, 250, 252, 254, 256, 258, 260, 262, 264, 266, 268, 270, 272, 274, 276, 278, 280, 282, 284, 286, 288, 290, 292, 294, 296, 298, 300, 302, 304, 306, 308, 310, 312, 314, 316, 318, 320, 322, 324, 326, 328, 330, 332, 334, 336, 338, 340, 342, 344, 346, 348, 350, 352, 354, 356, 358, 360, 362, 364, 366, 368, 370, 372, 374, 376, 378, 380, 382, 384, 386, 388, 390, 392, 394, 396, 398, 400 ]),  # Replace with your actual data
    'TL Intensity': np.array([1193, 1043, 1059, 1213, 1549, 1993, 2567, 3266, 4141, 4936, 5969, 7400, 8934, 10649, 12515, 14872, 17728, 20870, 24713, 28948, 33399, 38684, 43853, 49208, 54183, 59453, 61766, 64770, 64811, 63687, 60777, 56846, 51558, 46701, 40251, 33715, 27019, 21443, 16541, 13574, 11493, 9779, 9286, 8352, 7396, 7014, 6409, 5937, 5826, 5982, 6116, 6389, 6565, 6549, 6497, 6493, 6192, 6127, 6210, 6080, 5986, 5980, 6069, 5762, 5858, 6242, 6365, 6209, 5963, 5923, 6008, 5751, 5635, 5592, 5788, 5943, 5690, 5583, 5184, 4778, 4328, 4011, 3307, 2844, 2211, 1917, 1493, 1267, 952, 813, 725, 563, 500, 425, 376, 371, 420, 312, 341, 354, 364, 310, 345, 265, 294, 277, 312, 257, 254, 232, 307, 232, 239, 200, 199, 203, 196, 199, 216, 171, 242, 147, 171, 238, 239, 197, 178, 204, 159, 217, 165, 187, 166, 141, 172, 183, 152, 187, 155, 159, 194, 138, 183, 172, 233, 219, 183, 176, 196, 199, 164, 141, 194, 134, 137, 153, 149, 126, 154, 123, 136, 149, 135, 143, 143, 141, 113, 128, 146, 96, 125, 93, 127, 137, 143, 125, 125, 112, 59, 135, 98, 144, 88, 99, 153, 85, 86, 150, 147, 100, 136
])      # Replace with your actual data
}

data30Gy = {
    'Temperature': np.array([20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124, 126, 128, 130, 132, 134, 136, 138, 140, 142, 144, 146, 148, 150, 152, 154, 156, 158, 160, 162, 164, 166, 168, 170, 172, 174, 176, 178, 180, 182, 184, 186, 188, 190, 192, 194, 196, 198, 200, 202, 204, 206, 208, 210, 212, 214, 216, 218, 220, 222, 224, 226, 228, 230, 232, 234, 236, 238, 240, 242, 244, 246, 248, 250, 252, 254, 256, 258, 260, 262, 264, 266, 268, 270, 272, 274, 276, 278, 280, 282, 284, 286, 288, 290, 292, 294, 296, 298, 300, 302, 304, 306, 308, 310, 312, 314, 316, 318, 320, 322, 324, 326, 328, 330, 332, 334, 336, 338, 340, 342, 344, 346, 348, 350, 352, 354, 356, 358, 360, 362, 364, 366, 368, 370, 372, 374, 376, 378, 380, 382, 384, 386, 388, 390, 392, 394, 396, 398, 400 ]),  # Replace with your actual data
    'TL Intensity': np.array([1257, 1315, 1266, 1593, 1909, 2663, 3242, 3749, 4754, 6086, 7536, 8846, 10959, 12823, 15742, 18339, 21726, 25658, 30381, 35300, 41068, 47214, 53554, 59214, 64982, 70144, 73039, 75218, 75018, 71913, 68397, 63082, 57118, 50558, 43694, 36317, 29132, 23075, 18130, 15161, 13043, 11588, 10687, 9804, 9279, 8629, 8177, 7985, 7855, 7984, 8163, 8437, 8264, 8536, 8727, 8949, 8708, 8329, 8238, 8145, 8020, 7921, 7890, 8038, 7991, 7888, 8181, 8177, 7942, 7827, 7892, 8092, 7906, 7754, 8059, 7861, 7809, 7574, 6940, 6477, 5800, 5466, 4661, 3876, 3368, 2650, 2081, 1629, 1540, 1175, 929, 801, 702, 671, 623, 541, 511, 615, 493, 517, 457, 486, 385, 496, 370, 412, 353, 411, 432, 315, 314, 330, 311, 308, 310, 252, 319, 322, 377, 288, 251, 240, 267, 247, 316, 283, 306, 270, 257, 210, 250, 221, 217, 247, 193, 198, 211, 264, 229, 214, 223, 224, 222, 257, 167, 195, 250, 192, 288, 160, 186, 242, 198, 187, 264, 157, 198, 165, 192, 174, 167, 189, 149, 148, 103, 144, 142, 145, 170, 133, 152, 175, 165, 105, 106, 141, 162, 86, 137, 144, 134, 109, 147, 159, 170, 114, 103, 101, 103, 139, 121
])     # Replace with your actual data
}

data40Gy = {
    'Temperature': np.array([20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124, 126, 128, 130, 132, 134, 136, 138, 140, 142, 144, 146, 148, 150, 152, 154, 156, 158, 160, 162, 164, 166, 168, 170, 172, 174, 176, 178, 180, 182, 184, 186, 188, 190, 192, 194, 196, 198, 200, 202, 204, 206, 208, 210, 212, 214, 216, 218, 220, 222, 224, 226, 228, 230, 232, 234, 236, 238, 240, 242, 244, 246, 248, 250, 252, 254, 256, 258, 260, 262, 264, 266, 268, 270, 272, 274, 276, 278, 280, 282, 284, 286, 288, 290, 292, 294, 296, 298, 300, 302, 304, 306, 308, 310, 312, 314, 316, 318, 320, 322, 324, 326, 328, 330, 332, 334, 336, 338, 340, 342, 344, 346, 348, 350, 352, 354, 356, 358, 360, 362, 364, 366, 368, 370, 372, 374, 376, 378, 380, 382, 384, 386, 388, 390, 392, 394, 396, 398, 400 ]),  # Replace with your actual data
    'TL Intensity': np.array([1561, 1506, 1518, 1739, 2236, 3135, 3699, 4623, 5876, 7104, 8716, 10259, 12664, 15252, 17973, 21593, 25707, 30024, 35679, 41132, 47800, 54849, 61629, 67850, 74862, 78612, 81243, 81746, 79708, 76874, 70933, 65022, 58328, 51270, 44488, 37581, 30985, 25013, 19965, 16714, 14373, 13344, 12190, 11516, 11074, 10473, 9799, 10284, 10046, 9948, 10184, 10598, 10795, 10988, 11155, 11135, 10942, 10841, 10407, 10283, 10050, 10191, 9996, 9793, 9953, 10068, 10208, 10157, 10269, 10225, 9950, 10242, 10258, 9931, 10125, 9791, 9829, 9286, 8793, 8484, 7796, 6693, 6261, 4984, 4264, 3676, 2875, 2327, 1961, 1648, 1289, 1119, 1056, 937, 859, 797, 758, 590, 664, 608, 569, 569, 545, 561, 567, 486, 438, 494, 461, 474, 476, 523, 465, 446, 437, 415, 412, 378, 368, 411, 341, 323, 326, 395, 339, 349, 361, 346, 351, 267, 413, 350, 320, 328, 391, 289, 319, 319, 331, 305, 290, 277, 296, 320, 290, 356, 319, 319, 273, 255, 244, 251, 265, 288, 249, 229, 228, 208, 243, 241, 239, 183, 185, 175, 260, 158, 218, 184, 155, 165, 92, 168, 212, 111, 146, 172, 133, 130, 143, 143, 127, 160, 95, 119, 258, 115, 83, 104, 112, 90, 147
])     # Replace with your actual data
}

data50Gy = {
    'Temperature': np.array([20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124, 126, 128, 130, 132, 134, 136, 138, 140, 142, 144, 146, 148, 150, 152, 154, 156, 158, 160, 162, 164, 166, 168, 170, 172, 174, 176, 178, 180, 182, 184, 186, 188, 190, 192, 194, 196, 198, 200, 202, 204, 206, 208, 210, 212, 214, 216, 218, 220, 222, 224, 226, 228, 230, 232, 234, 236, 238, 240, 242, 244, 246, 248, 250, 252, 254, 256, 258, 260, 262, 264, 266, 268, 270, 272, 274, 276, 278, 280, 282, 284, 286, 288, 290, 292, 294, 296, 298, 300, 302, 304, 306, 308, 310, 312, 314, 316, 318, 320, 322, 324, 326, 328, 330, 332, 334, 336, 338, 340, 342, 344, 346, 348, 350, 352, 354, 356, 358, 360, 362, 364, 366, 368, 370, 372, 374, 376, 378, 380, 382, 384, 386, 388, 390, 392, 394, 396, 398, 400 ]),  # Replace with your actual data
    'TL Intensity': np.array([1735, 1702, 1810, 2136, 2630, 3375, 4191, 5257, 6465, 8204, 9873, 11764, 14573, 17410, 20711, 24662, 29066, 34163, 40110, 46876, 54261, 60820, 68048, 75846, 81789, 86199, 88231, 86813, 84330, 78545, 71021, 64939, 57528, 50408, 43764, 36879, 31126, 25807, 21368, 18255, 15830, 14706, 13492, 13211, 12874, 12229, 11916, 12065, 12165, 12159, 12754, 13093, 13396, 13569, 13661, 13625, 13310, 13101, 13272, 12484, 12467, 12166, 11882, 12093, 11816, 12264, 12324, 12438, 12561, 12451, 12557, 12000, 12489, 12364, 11985, 11931, 11734, 11477, 10678, 10223, 9551, 8407, 7314, 6326, 5424, 4457, 3689, 3066, 2494, 2111, 1749, 1526, 1535, 1304, 1221, 1053, 1101, 1017, 881, 856, 841, 822, 770, 754, 724, 685, 693, 676, 570, 641, 613, 576, 599, 558, 598, 624, 601, 569, 602, 534, 486, 534, 557, 498, 460, 462, 452, 537, 534, 452, 436, 489, 456, 419, 446, 394, 491, 375, 384, 500, 445, 456, 388, 439, 474, 386, 374, 403, 381, 337, 362, 277, 289, 320, 328, 320, 290, 318, 242, 321, 216, 227, 224, 177, 172, 220, 190, 163, 193, 180, 124, 156, 173, 124, 110, 129, 148, 116, 99, 145, 103, 105, 132, 125, 112, 114, 116, 151, 131, 145, 180
])     # Replace with your actual data
}

# Define the TL Model Function
def TLModel(T, Im, E, s, b):
    k = 8.617e-5  # Boltzmann constant in eV/K
    return Im * np.exp(-E / (k * T)) * (1 + ((b - 1) * s * T**2) / (b * E))**((b - 1) / b)

# Perform Curve Fitting
fit_params10Gy, _ = curve_fit(TLModel, data10Gy['Temperature'], data10Gy['TL Intensity'], p0=[100, 1, 1, 1])
fit_params20Gy, _ = curve_fit(TLModel, data20Gy['Temperature'], data20Gy['TL Intensity'], p0=[100, 1, 1, 1])
fit_params30Gy, _ = curve_fit(TLModel, data30Gy['Temperature'], data30Gy['TL Intensity'], p0=[100, 1, 1, 1])
fit_params40Gy, _ = curve_fit(TLModel, data40Gy['Temperature'], data40Gy['TL Intensity'], p0=[100, 1, 1, 1])
fit_params50Gy, _ = curve_fit(TLModel, data50Gy['Temperature'], data50Gy['TL Intensity'], p0=[100, 1, 1, 1])

# Plot the Data and Fitted Curves
plt.figure(figsize=(12, 8))

# Plot for 10Gy
plt.plot(data10Gy['Temperature'], data10Gy['TL Intensity'], 'o-', label='10Gy Data')
plt.plot(data10Gy['Temperature'], TLModel(data10Gy['Temperature'], *fit_params10Gy), '--', label='10Gy Fit')

# Plot for 20Gy
plt.plot(data20Gy['Temperature'], data20Gy['TL Intensity'], 'o-', label='20Gy Data')
plt.plot(data20Gy['Temperature'], TLModel(data20Gy['Temperature'], *fit_params20Gy), '--', label='20Gy Fit')

# Plot for 30Gy
plt.plot(data30Gy['Temperature'], data30Gy['TL Intensity'], 'o-', label='30Gy Data')
plt.plot(data30Gy['Temperature'], TLModel(data30Gy['Temperature'], *fit_params30Gy), '--', label='30Gy Fit')

# Plot for 40Gy
plt.plot(data40Gy['Temperature'], data40Gy['TL Intensity'], 'o-', label='40Gy Data')
plt.plot(data40Gy['Temperature'], TLModel(data40Gy['Temperature'], *fit_params40Gy), '--', label='40Gy Fit')

# Plot for 50Gy
plt.plot(data50Gy['Temperature'], data50Gy['TL Intensity'], 'o-', label='50Gy Data')
plt.plot(data50Gy['Temperature'], TLModel(data50Gy['Temperature'], *fit_params50Gy), '--', label='50Gy Fit')

# Add labels and legend
plt.xlabel('Temperature (K)')
plt.ylabel('TL Intensity')
plt.title('TL Glow Curves with Curve Fitting')
plt.legend()
plt.grid(True)
plt.show()
