import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit

# Manually input the data for each Gy level
data10Gy = {
    'Temperature': np.array([20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124, 126, 128, 130, 132, 134, 136, 138, 140, 142, 144, 146, 148, 150, 152, 154, 156, 158, 160, 162, 164, 166, 168, 170, 172, 174, 176, 178, 180, 182, 184, 186, 188, 190, 192, 194, 196, 198, 200, 202, 204, 206, 208 ]),  # Replace with your actual data

    'TL Intensity': np.array([773, 727, 828, 1056, 1255, 1711, 2108, 2624, 3263, 4017, 4919, 5898, 6869, 8173, 9619, 11401, 13441, 15575, 18490, 21841, 25003, 29088, 33798, 37320, 41608, 45455, 48769, 50347, 50952, 51161, 49833, 45783, 42782, 38560, 33230, 28048, 22461, 17852, 13894, 11404, 9845, 8727, 7868, 7090, 6598, 5937, 5322, 4827, 5038, 5044, 4890, 5241, 5209, 5417, 5457, 5439, 5304, 5536, 5256, 5462, 5615, 5377, 5401, 5522, 5359, 5382, 5162, 5070, 4961, 4799, 4454, 4385, 4221, 4124, 4069, 4039, 4032, 3787, 3517, 3583, 2915, 2585, 2326, 1905, 1623, 1307, 997, 770, 646, 545, 474, 398, 445, 335, 318
])      # Replace with your actual data
}

data20Gy = {
    'Temperature': np.array([20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124, 126, 128, 130, 132, 134, 136, 138, 140, 142, 144, 146, 148, 150, 152, 154, 156, 158, 160, 162, 164, 166, 168, 170, 172, 174, 176, 178, 180, 182, 184, 186, 188, 190, 192, 194, 196, 198, 200, 202, 204, 206, 208 ]),  # Replace with your actual data
    'TL Intensity': np.array([1193, 1043, 1059, 1213, 1549, 1993, 2567, 3266, 4141, 4936, 5969, 7400, 8934, 10649, 12515, 14872, 17728, 20870, 24713, 28948, 33399, 38684, 43853, 49208, 54183, 59453, 61766, 64770, 64811, 63687, 60777, 56846, 51558, 46701, 40251, 33715, 27019, 21443, 16541, 13574, 11493, 9779, 9286, 8352, 7396, 7014, 6409, 5937, 5826, 5982, 6116, 6389, 6565, 6549, 6497, 6493, 6192, 6127, 6210, 6080, 5986, 5980, 6069, 5762, 5858, 6242, 6365, 6209, 5963, 5923, 6008, 5751, 5635, 5592, 5788, 5943, 5690, 5583, 5184, 4778, 4328, 4011, 3307, 2844, 2211, 1917, 1493, 1267, 952, 813, 725, 563, 500, 425, 376
])      # Replace with your actual data
}

data30Gy = {
    'Temperature': np.array([20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124, 126, 128, 130, 132, 134, 136, 138, 140, 142, 144, 146, 148, 150, 152, 154, 156, 158, 160, 162, 164, 166, 168, 170, 172, 174, 176, 178, 180, 182, 184, 186, 188, 190, 192, 194, 196, 198, 200, 202, 204, 206, 208 ]),  # Replace with your actual data
    'TL Intensity': np.array([1257, 1315, 1266, 1593, 1909, 2663, 3242, 3749, 4754, 6086, 7536, 8846, 10959, 12823, 15742, 18339, 21726, 25658, 30381, 35300, 41068, 47214, 53554, 59214, 64982, 70144, 73039, 75218, 75018, 71913, 68397, 63082, 57118, 50558, 43694, 36317, 29132, 23075, 18130, 15161, 13043, 11588, 10687, 9804, 9279, 8629, 8177, 7985, 7855, 7984, 8163, 8437, 8264, 8536, 8727, 8949, 8708, 8329, 8238, 8145, 8020, 7921, 7890, 8038, 7991, 7888, 8181, 8177, 7942, 7827, 7892, 8092, 7906, 7754, 8059, 7861, 7809, 7574, 6940, 6477, 5800, 5466, 4661, 3876, 3368, 2650, 2081, 1629, 1540, 1175, 929, 801, 702, 671, 623
])     # Replace with your actual data
}

data40Gy = {
    'Temperature': np.array([20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124, 126, 128, 130, 132, 134, 136, 138, 140, 142, 144, 146, 148, 150, 152, 154, 156, 158, 160, 162, 164, 166, 168, 170, 172, 174, 176, 178, 180, 182, 184, 186, 188, 190, 192, 194, 196, 198, 200, 202, 204, 206, 208 ]),  # Replace with your actual data
    'TL Intensity': np.array([1561, 1506, 1518, 1739, 2236, 3135, 3699, 4623, 5876, 7104, 8716, 10259, 12664, 15252, 17973, 21593, 25707, 30024, 35679, 41132, 47800, 54849, 61629, 67850, 74862, 78612, 81243, 81746, 79708, 76874, 70933, 65022, 58328, 51270, 44488, 37581, 30985, 25013, 19965, 16714, 14373, 13344, 12190, 11516, 11074, 10473, 9799, 10284, 10046, 9948, 10184, 10598, 10795, 10988, 11155, 11135, 10942, 10841, 10407, 10283, 10050, 10191, 9996, 9793, 9953, 10068, 10208, 10157, 10269, 10225, 9950, 10242, 10258, 9931, 10125, 9791, 9829, 9286, 8793, 8484, 7796, 6693, 6261, 4984, 4264, 3676, 2875, 2327, 1961, 1648, 1289, 1119, 1056, 937, 859
])     # Replace with your actual data
}

data50Gy = {
    'Temperature': np.array([20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124, 126, 128, 130, 132, 134, 136, 138, 140, 142, 144, 146, 148, 150, 152, 154, 156, 158, 160, 162, 164, 166, 168, 170, 172, 174, 176, 178, 180, 182, 184, 186, 188, 190, 192, 194, 196, 198, 200, 202, 204, 206, 208 ]),  # Replace with your actual data
    'TL Intensity': np.array([1735, 1702, 1810, 2136, 2630, 3375, 4191, 5257, 6465, 8204, 9873, 11764, 14573, 17410, 20711, 24662, 29066, 34163, 40110, 46876, 54261, 60820, 68048, 75846, 81789, 86199, 88231, 86813, 84330, 78545, 71021, 64939, 57528, 50408, 43764, 36879, 31126, 25807, 21368, 18255, 15830, 14706, 13492, 13211, 12874, 12229, 11916, 12065, 12165, 12159, 12754, 13093, 13396, 13569, 13661, 13625, 13310, 13101, 13272, 12484, 12467, 12166, 11882, 12093, 11816, 12264, 12324, 12438, 12561, 12451, 12557, 12000, 12489, 12364, 11985, 11931, 11734, 11477, 10678, 10223, 9551, 8407, 7314, 6326, 5424, 4457, 3689, 3066, 2494, 2111, 1749, 1526, 1535, 1304, 1221
])     # Replace with your actual data
}

# Define the TL Model Function
def TLModel(T, Im, E, s, b):
    k = 8.617e-5  # Boltzmann constant in eV/K
    return Im * np.exp(-E / (k * T)) * (1 + ((b - 1) * s * T**2) / (b * E))**((b - 1) / b)

# Perform Curve Fitting
fit_params10Gy, _ = curve_fit(TLModel, data10Gy['Temperature'], data10Gy['TL Intensity'], p0=[100, 1, 1, 1])
fit_params20Gy, _ = curve_fit(TLModel, data20Gy['Temperature'], data20Gy['TL Intensity'], p0=[100, 1, 1, 1])
fit_params30Gy, _ = curve_fit(TLModel, data30Gy['Temperature'], data30Gy['TL Intensity'], p0=[100, 1, 1, 1])
fit_params40Gy, _ = curve_fit(TLModel, data40Gy['Temperature'], data40Gy['TL Intensity'], p0=[100, 1, 1, 1])
fit_params50Gy, _ = curve_fit(TLModel, data50Gy['Temperature'], data50Gy['TL Intensity'], p0=[100, 1, 1, 1])

# Plot the Data and Fitted Curves
plt.figure(figsize=(12, 8))

# Plot for 10Gy
plt.plot(data10Gy['Temperature'], data10Gy['TL Intensity'], 'o-', label='10Gy Data')
plt.plot(data10Gy['Temperature'], TLModel(data10Gy['Temperature'], *fit_params10Gy), '--', label='10Gy Fit')

# Plot for 20Gy
plt.plot(data20Gy['Temperature'], data20Gy['TL Intensity'], 'o-', label='20Gy Data')
plt.plot(data20Gy['Temperature'], TLModel(data20Gy['Temperature'], *fit_params20Gy), '--', label='20Gy Fit')

# Plot for 30Gy
plt.plot(data30Gy['Temperature'], data30Gy['TL Intensity'], 'o-', label='30Gy Data')
plt.plot(data30Gy['Temperature'], TLModel(data30Gy['Temperature'], *fit_params30Gy), '--', label='30Gy Fit')

# Plot for 40Gy
plt.plot(data40Gy['Temperature'], data40Gy['TL Intensity'], 'o-', label='40Gy Data')
plt.plot(data40Gy['Temperature'], TLModel(data40Gy['Temperature'], *fit_params40Gy), '--', label='40Gy Fit')

# Plot for 50Gy
plt.plot(data50Gy['Temperature'], data50Gy['TL Intensity'], 'o-', label='50Gy Data')
plt.plot(data50Gy['Temperature'], TLModel(data50Gy['Temperature'], *fit_params50Gy), '--', label='50Gy Fit')

# Add labels and legend
plt.xlabel('Temperature (C)')
plt.ylabel('TL Intensity')
plt.title('TL Glow Curves with Curve Fitting')
plt.legend()
plt.grid(True)
plt.show()
